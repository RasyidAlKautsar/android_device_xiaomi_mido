<!--
/******************************************************************************
  @file    GameOptimizationFeature.xml
  @brief   Game Optimization feature xml
  DESCRIPTION
      Each feature has an xml file to define the feature components
  ===========================================================================
  Copyright (c) 2017-2019 Qualcomm Technologies, Inc.
  All Rights Reserved.
  Confidential and Proprietary - Qualcomm Technologies, Inc.
  ===========================================================================
******************************************************************************/
-->
<!--
    Follows "Data goes into elements, metadata goes into attributes"
 -->

<Feature>
    <Name>GameOptimization</Name>
    <Libname>libgameoptfeature.so</Libname>
    <Configs>
        <Enable>1</Enable>
        <AGTL1>0</AGTL1>
        <AGTL2>0</AGTL2>
        <AGTL3>0</AGTL3>
        <GFAR>0</GFAR>
        <AGPE>0</AGPE>
        <IDLE_SENSE>0</IDLE_SENSE>
        <GROUP_UPMIGRATE_PATH>/proc/sys/kernel/sched_group_upmigrate</GROUP_UPMIGRATE_PATH>
        <GROUP_DOWNMIGRATE_PATH>/proc/sys/kernel/sched_group_downmigrate</GROUP_DOWNMIGRATE_PATH>
        <BIG_CLUSTER_ID>4,5,6,7</BIG_CLUSTER_ID>
        <BIG_SLB_OPCODE>0x40C00000,0x40C00000,0x40C00000,0x40C00000</BIG_SLB_OPCODE>
        <LITTLE_SLB_OPCODE>0x40C00000,0x40C00000,0x40C00000,0x40C00000</LITTLE_SLB_OPCODE>
        <!-- SLBval, TADemand, Jank-->
        <SLB_MAP>14,200,40,6,150,30,4,125,25,2,100,15,0</SLB_MAP>
        <STUTTER_SCALE>10</STUTTER_SCALE>
        <!-- This will enable SLB clamping if Janks are zero in consistent learning window-->
        <ENABLE_SLB_CLAMPER>1</ENABLE_SLB_CLAMPER>
        <!-- Default slb little,  Default slb big-->
        <AGT_L3_DEFAULTS>-6,-6</AGT_L3_DEFAULTS>
    </Configs>
    <Profiles>
        <!-- Heavy Game Default -->
        <!-- CPUBW_HWMON_MIN_FREQ, 30 -->
        <!-- MIN_FREQ_CLUSTER_LITTLE_CORE_0, 1600 -->
        <!-- SCHED_GROUP_DOWNMIGRATE, 75, SCHED_GROUP_UPMIGRATE, 90 -->
        <!-- GPU_MIN_PWRLVL, 6, GPU MIN_FREQUENCY, 345 -->
        <Profile>
            <DEFAULT_PROF>
            0x41800000, 30,
            0x40800100, 0x640,
            0x40C58000, 75, 0x40C54000, 90,
	    0x42804000, 0x6,0x4280C000, 596,
            </DEFAULT_PROF>
        </Profile>
        <!-- Agressive Profile - Junk detected -->
        <!-- CPUBW_HWMON_MIN_FREQ, 30 -->
        <!-- MIN_FREQ_CLUSTER_LITTLE_CORE_0, 1400 -->
        <!-- SCHED_GROUP_DOWNMIGRATE, 65, SCHED_GROUP_UPMIGRATE, 80 -->
        <!-- GPU_MIN_PWRLVL, 1, GPU MIN_FREQUENCY, 345 -->
        <Profile>
            <DEFAULT_PROF>
            0x41800000, 30,
            0x40800100, 0x578,
            0x40C58000, 65, 0x40C54000, 80,
	    0x42804000, 0x1,0x4280C000, 345,
            </DEFAULT_PROF>
        </Profile>
    </Profiles>

    <Meters>
        <SamplesRequired>4</SamplesRequired>

        <Meter>
            <Name>Fps</Name>
            <Triggers>
                <Trigger>
                   <Primary>true</Primary>
                   <AsyncId>VENDOR_HINT_APP_WORKLOAD_TYPE</AsyncId>
                   <AsyncType>1</AsyncType>
                </Trigger>

                <Trigger>
                   <Primary>true</Primary>
                   <AsyncId>VENDOR_HINT_TAP_EVENT</AsyncId>
                   <AsyncType>-1</AsyncType>
                </Trigger>

                <Trigger>
                   <Primary>true</Primary>
                   <AsyncId>VENDOR_HINT_SENSOR_DATA</AsyncId>
                   <AsyncType>1</AsyncType>
                </Trigger>

                <Trigger>
                   <Primary>true</Primary>
                   <AsyncId>VENDOR_HINT_WORKLOAD_HEAVY</AsyncId>
                   <AsyncType>1</AsyncType>
                </Trigger>
            </Triggers>
            <Configs>
                <FPS_NODE>/sys/devices/virtual/graphics/fb0/measured_fps</FPS_NODE>
                <FPS_PERIODICITY_NODE>/sys/devices/virtual/graphics/fb0/dynamic_fps</FPS_PERIODICITY_NODE>
            </Configs>
            <Samples>80</Samples>
        </Meter>

        <Meter>
            <Name>SchedParams</Name>
            <Triggers>
                <Trigger>
                   <Primary>true</Primary>
                   <AsyncId>VENDOR_HINT_APP_WORKLOAD_TYPE</AsyncId>
                   <AsyncType>1</AsyncType>
                </Trigger>

                <Trigger>
                   <Primary>true</Primary>
                   <AsyncId>VENDOR_HINT_TAP_EVENT</AsyncId>
                   <AsyncType>-1</AsyncType>
                </Trigger>

            </Triggers>
            <Samples>80</Samples>
        </Meter>
    </Meters>
    <IgnoredApps>
        <App>com.google.android.gms</App>
        <App>com.android.vending</App>
        <App>com.google.android.projection.gearhead</App>
    </IgnoredApps>
</Feature>